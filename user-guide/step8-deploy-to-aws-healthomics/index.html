<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
      <link rel="shortcut icon" href="../../img/favicon.ico" />
    <title>Step 8: Deploy to AWS HealthOmics - Flow-IQ Docs</title>
    <link rel="stylesheet" href="../../css/theme.css" />
    <link rel="stylesheet" href="../../css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css" />
        <link href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.2/dist/css/bootstrap.min.css" rel="stylesheet" />
        <link href="../../explorer/stylesheets/extra.css" rel="stylesheet" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "Step 8: Deploy to AWS HealthOmics";
        var mkdocs_page_input_path = "user-guide/step8-deploy-to-aws-healthomics.md";
        var mkdocs_page_url = null;
      </script>
    
    <!--[if lt IE 9]>
      <script src="../../js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
      <script>hljs.highlightAll();</script> 
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href="../.." class="icon icon-home"> Flow-IQ Docs
        </a><div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../../search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../..">Home</a>
                </li>
              </ul>
              <p class="caption"><span class="caption-text">Getting Started</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../getting-started/about-flowiq/">About Flow-IQ</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../getting-started/what-you-should-know/">Before You Start: What You Should Know</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">User Guide</span></p>
              <ul class="current">
                  <li class="toctree-l1"><a class="reference internal" href="../">Custom Pipeline Development</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../step1-locate-module/">Step 1: Locate the Module</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../step2-understanding-nfcore-modules/">Step 2: Understand How nf-core Modules Work</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../step3-create-pipeline/">Step 3: Create a pipeline</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../step4-install-manta-module/">Step 4: Install the Manta Module</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../step5-build-a-one-step-workflow/">Step 5: Build a One-Step Workflow</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../step6-test-on-biowulf/">Step 6: Test on Biowulf HPC</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../step7-prepare-for-aws-healthomics/">Step 7: Prepare for AWS HealthOmics</a>
                  </li>
                  <li class="toctree-l1 current"><a class="reference internal current" href="#">Step 8: Deploy to AWS HealthOmics</a>
    <ul class="current">
    <li class="toctree-l2"><a class="reference internal" href="#container-requirements">üì¶ Container Requirements</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#step-1-upload-the-container-to-private-ecr">Step 1: Upload the Container to Private ECR</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#step-2-prepare-workflow-definition-and-parameters">Step 2: Prepare Workflow Definition and Parameters</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#step-3-create-the-workflow">Step 3: Create the Workflow</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#step-4-start-a-run">Step 4: Start a Run</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#job-monitoring">üìä Job Monitoring</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#automation-tip">üõ†Ô∏è Automation Tip</a>
    </li>
    </ul>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Troubleshooting & Tips</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../troubleshooting/troubleshooting-and-tips/">Seqera AI: Bioinformatics Agent for Nextflow</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Explorer</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../explorer/">Flow-IQ</a>
                  </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../..">Flow-IQ Docs</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../.." class="icon icon-home" aria-label="Docs"></a></li>
          <li class="breadcrumb-item">User Guide</li>
      <li class="breadcrumb-item active">Step 8: Deploy to AWS HealthOmics</li>
    <li class="wy-breadcrumbs-aside">
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <h1 id="step-8-deploy-to-aws-healthomics">Step 8: Deploy to AWS HealthOmics</h1>
<p>This step walks you through how to deploy a workflow to <a href="https://aws.amazon.com/healthomics/">AWS HealthOmics</a>, focusing on setting up your containers, uploading your workflow and parameters, and running it in the cloud.</p>
<p>Start by visiting the AWS HealthOmics landing page:</p>
<p float="left">
  <img src="../assets/health-omics-landing-page.png" width="100%" />
</p>

<p>AWS HealthOmics provides three main services:</p>
<ul>
<li><strong>Storage</strong></li>
<li><strong>Workflows</strong></li>
<li><strong>Analytics</strong></li>
</ul>
<p>For our purposes, we‚Äôll focus on <strong>Workflows</strong>. Select <strong>Create workflows</strong> under the <em>Bioinformatics workflows</em> section:</p>
<p float="left">
  <img src="../assets/health-omics-select-bioinformatics-workflows.png" width="100%" />
</p>

<p>On the next screen, the <strong>How it works</strong> panel outlines the four major steps to create and run a workflow:</p>
<p float="left">
  <img src="../assets/health-omics-workflows-how-it-works.png" width="100%" />
</p>

<hr />
<h2 id="container-requirements">üì¶ Container Requirements</h2>
<p>A key requirement for using AWS HealthOmics is that <strong>all containers used in workflows must be stored in Amazon Elastic Container Registry (ECR)</strong> ‚Äî AWS‚Äôs managed Docker image service. Public registries like <code>quay.io</code> or <code>Docker Hub</code> are not supported directly.</p>
<p>In our case, the container required by a module is defined in <code>manta/germline/main.nf</code>:</p>
<pre><code class="language-groovy">container &quot;${ workflow.containerEngine == 'singularity' &amp;&amp; !task.ext.singularity_pull_docker_container ?
  'https://depot.galaxyproject.org/singularity/manta:1.6.0--h9ee0642_1' :
  'biocontainers/manta:1.6.0--h9ee0642_1' }&quot;
</code></pre>
<p>We also see in <code>nextflow.config</code>:</p>
<pre><code class="language-groovy">docker.registry = 'quay.io'
</code></pre>
<p>This means we need to pull the image locally from <code>quay.io</code> and push it to a <strong>private ECR repository</strong> so HealthOmics can access it.</p>
<hr />
<h2 id="step-1-upload-the-container-to-private-ecr">Step 1: Upload the Container to Private ECR</h2>
<p>Navigate to <strong>Amazon ECR &gt; Private repositories</strong> and click <strong>Create repository</strong>. For the name, use something like <code>biocontainers/manta</code>.</p>
<p float="left">
  <img src="../assets/ecr-private-registry.png" width="100%" />
</p>

<p float="left">
  <img src="../assets/ecr-create-private-repo.png" width="100%" />
</p>

<p>Once created, go to the repository and click <strong>View push commands</strong>. This provides the full set of <code>docker</code> and <code>awscli</code> commands needed to push your image:</p>
<pre><code class="language-bash"># Authenticate with ECR
$ aws ecr get-login-password --region us-east-1 \
  | docker login --username AWS \
    --password-stdin 222634394918.dkr.ecr.us-east-1.amazonaws.com

# Pull from quay.io
$ docker pull quay.io/biocontainers/manta:1.6.0--h9ee0642_1

# Tag and push to your private ECR
$ docker tag quay.io/biocontainers/manta:1.6.0--h9ee0642_1 \
  222634394918.dkr.ecr.us-east-1.amazonaws.com/biocontainers/manta:1.6.0--h9ee0642_1

$ docker push 222634394918.dkr.ecr.us-east-1.amazonaws.com/biocontainers/manta:1.6.0--h9ee0642_1
</code></pre>
<p float="left">
  <img src="../assets/ecr-manta-pushed.png" width="100%" />
</p>

<hr />
<h2 id="step-2-prepare-workflow-definition-and-parameters">Step 2: Prepare Workflow Definition and Parameters</h2>
<p>HealthOmics requires:</p>
<ul>
<li>A <strong>workflow definition</strong> (e.g., a Nextflow script)</li>
<li>A <strong>JSON file</strong> containing the input parameters</li>
</ul>
<p>You already have the Nextflow pipeline; now you need to generate the corresponding parameter file.</p>
<p>Use the <code>nf-core</code> CLI to do this:</p>
<pre><code class="language-bash">nf-core pipelines --create-params-file
# or
nf-core pipelines --launch
</code></pre>
<p>Both methods generate a <code>nf-params.json</code> file, which you can upload directly to HealthOmics.</p>
<hr />
<h2 id="step-3-create-the-workflow">Step 3: Create the Workflow</h2>
<p>Click <strong>Create workflow</strong> in the HealthOmics Workflows section:</p>
<p float="left">
  <img src="../assets/healthomics-create-workflow.png" width="100%" />
</p>

<p>In the setup wizard, provide:</p>
<ul>
<li>A workflow name and description</li>
<li>The workflow language (e.g., Nextflow)</li>
<li>Path to the script (local file or S3)</li>
<li>Your parameter file (<code>nf-params.json</code>) ‚Äî recommended to avoid manual errors</li>
</ul>
<p>You‚Äôll also be asked to define:</p>
<ul>
<li>Parameter types (required, optional)</li>
<li>Descriptions</li>
<li>Any additional custom parameters</li>
</ul>
<p float="left">
  <img src="../assets/healthomics-create-workflow2.png" width="100%" />
</p>

<p><br></p>
<p>Once configured, click <strong>Create workflow</strong>. You‚Äôll be returned to the dashboard and can now proceed to run the workflow.</p>
<p float="left">
  <img src="../assets/healthomics-create-workflow3.png" width="100%" />
</p>

<hr />
<p><br><br></p>
<h2 id="step-4-start-a-run">Step 4: Start a Run</h2>
<p>You‚Äôre now ready to run the workflow! Click <strong>Start run</strong> and complete the wizard.</p>
<p float="left">
  <img src="../assets/healthomics-run-workflow.png" width="100%" />
</p>

<p>One important detail: <strong>You must provide a Service Role</strong> during this step. This role allows HealthOmics to interact with other AWS resources like S3 buckets. If you don‚Äôt have permission to create IAM roles, you‚Äôll need help from an AWS admin.</p>
<p>See: <a href="https://docs.aws.amazon.com/omics/latest/dev/permissions-service.html">Service roles for AWS HealthOmics</a></p>
<p float="left">
  <img src="../assets/healthomics-run-workflow2.png" width="100%" />
</p>

<hr />
<p><br></p>
<h2 id="job-monitoring">üìä Job Monitoring</h2>
<p>After launching a run, HealthOmics provides tools to monitor job status, review logs, and inspect output artifacts directly through the dashboard.</p>
<p float="left">
  <img src="../assets/healthomics-run-workflow3.png" width="100%" />
</p>

<hr />
<p><br></p>
<h2 id="automation-tip">üõ†Ô∏è Automation Tip</h2>
<p>All of these steps ‚Äî uploading containers, defining workflows, starting runs ‚Äî can be automated using the AWS CLI or SDKs. This is useful for CI/CD or scaling to many analyses.</p>
              
            </div>
          </div><footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="Footer Navigation">
        <a href="../step7-prepare-for-aws-healthomics/" class="btn btn-neutral float-left" title="Step 7: Prepare for AWS HealthOmics"><span class="icon icon-circle-arrow-left"></span> Previous</a>
        <a href="../../troubleshooting/troubleshooting-and-tips/" class="btn btn-neutral float-right" title="Seqera AI: Bioinformatics Agent for Nextflow">Next <span class="icon icon-circle-arrow-right"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
          
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
    
      <span><a href="../step7-prepare-for-aws-healthomics/" style="color: #fcfcfc">&laquo; Previous</a></span>
    
    
      <span><a href="../../troubleshooting/troubleshooting-and-tips/" style="color: #fcfcfc">Next &raquo;</a></span>
    
  </span>
</div>
    <script src="../../js/jquery-3.6.0.min.js"></script>
    <script>var base_url = "../..";</script>
    <script src="../../js/theme_extra.js"></script>
    <script src="../../js/theme.js"></script>
      <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
      <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.2/dist/js/bootstrap.bundle.min.js"></script>
      <script src="../../search/main.js"></script>
    <script>
        jQuery(function () {
            SphinxRtdTheme.Navigation.enable(true);
        });
    </script>

</body>
</html>
